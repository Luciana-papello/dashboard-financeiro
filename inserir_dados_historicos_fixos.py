"""
Script para inserir DADOS HIST√ìRICOS FIXOS (2022, 2023, 2024)
Estes dados N√ÉO ser√£o recalculados pela calculadora.py
"""

from app import app, db
from models.valor_mensal import ValorMensal

def inserir_ou_atualizar(conta_id, mes, ano, valor):
    """Insere ou atualiza um valor no banco"""
    existe = ValorMensal.query.filter_by(conta_id=conta_id, mes=mes, ano=ano).first()
    if existe:
        existe.valor = valor
        return "atualizado"
    else:
        novo = ValorMensal(conta_id=conta_id, mes=mes, ano=ano, valor=valor)
        db.session.add(novo)
        return "criado"

def main():
    app.app_context().push()
    
    print("=" * 70)
    print("üîí INSER√á√ÉO DE DADOS HIST√ìRICOS FIXOS (2022, 2023, 2024)")
    print("=" * 70)
    print("‚ö†Ô∏è  Estes dados N√ÉO ser√£o recalculados pela calculadora.py")
    print()
    
    total_inserido = 0
    
    # =========================================================================
    # ID 37 - TOTAL DISPON√çVEL (2023, 2024)
    # =========================================================================
    print("üìä Inserindo ID 37 - TOTAL DISPON√çVEL...")
    
    # 2023
    dados_37_2023 = [
        (1, 33821.39), (2, 67356.92), (3, 21609.05), (4, 80476.41),
        (5, 225655.78), (6, 81262.59), (7, 171719.37), (8, 91689.05),
        (9, 156063.30), (10, 634134.52), (11, 1193916.47), (12, 1068729.34)
    ]
    
    for mes, valor in dados_37_2023:
        status = inserir_ou_atualizar(37, mes, 2023, valor)
        print(f"  ‚úÖ 2023/{mes:02d}: R$ {valor:,.2f} ({status})")
        total_inserido += 1
    
    # 2024
    dados_37_2024 = [
        (1, 1094525.37), (2, 1054187.09), (3, 1128948.97), (4, 1207639.74),
        (5, 1468415.88), (6, 1678158.70), (7, 1194042.53), (8, 1083809.44),
        (9, 1090065.72), (10, 989599.12), (11, 835203.55), (12, 1108043.13)
    ]
    
    for mes, valor in dados_37_2024:
        status = inserir_ou_atualizar(37, mes, 2024, valor)
        print(f"  ‚úÖ 2024/{mes:02d}: R$ {valor:,.2f} ({status})")
        total_inserido += 1
    
    print()
    
    # =========================================================================
    # ID 1 - RECEITA OPERACIONAL (2022, 2023, 2024)
    # =========================================================================
    print("üìä Inserindo ID 1 - RECEITA OPERACIONAL...")
    
    # 2022
    dados_1_2022 = [
        (1, 1260407.28), (2, 1289977.00), (3, 1277462.50), (4, 1378648.35),
        (5, 1249565.34), (6, 1679334.75), (7, 1517698.16), (8, 1957251.97),
        (9, 1881439.92), (10, 1896711.52), (11, 2070247.93), (12, 2038745.54)
    ]
    
    for mes, valor in dados_1_2022:
        status = inserir_ou_atualizar(1, mes, 2022, valor)
        print(f"  ‚úÖ 2022/{mes:02d}: R$ {valor:,.2f} ({status})")
        total_inserido += 1
    
    # 2023
    dados_1_2023 = [
        (1, 1820196.86), (2, 1876313.00), (3, 2012322.72), (4, 1910801.27),
        (5, 2239750.21), (6, 1967979.63), (7, 2327903.28), (8, 2452495.87),
        (9, 2412553.33), (10, 3094133.32), (11, 3204661.26), (12, 2602166.27)
    ]
    
    for mes, valor in dados_1_2023:
        status = inserir_ou_atualizar(1, mes, 2023, valor)
        print(f"  ‚úÖ 2023/{mes:02d}: R$ {valor:,.2f} ({status})")
        total_inserido += 1
    
    # 2024
    dados_1_2024 = [
        (1, 2578933.66), (2, 2148673.53), (3, 2084884.15), (4, 2457701.28),
        (5, 2711292.85), (6, 2700955.18), (7, 2679545.50), (8, 2425979.87),
        (9, 2574696.56), (10, 3173923.50), (11, 2796051.30), (12, 2630931.11)
    ]
    
    for mes, valor in dados_1_2024:
        status = inserir_ou_atualizar(1, mes, 2024, valor)
        print(f"  ‚úÖ 2024/{mes:02d}: R$ {valor:,.2f} ({status})")
        total_inserido += 1
    
    print()
    
    # =========================================================================
    # ID 101 - RECEITA ACUMULADA ANUAL (2022, 2023, 2024)
    # =========================================================================
    print("üìä Inserindo ID 101 - RECEITA ACUMULADA ANUAL...")
    
    # 2022 - Acumulado m√™s a m√™s
    dados_101_2022 = [
        (1, 1260407.28),
        (2, 1260407.28 + 1289977.00),
        (3, 1260407.28 + 1289977.00 + 1277462.50),
        (4, 1260407.28 + 1289977.00 + 1277462.50 + 1378648.35),
        (5, 1260407.28 + 1289977.00 + 1277462.50 + 1378648.35 + 1249565.34),
        (6, 1260407.28 + 1289977.00 + 1277462.50 + 1378648.35 + 1249565.34 + 1679334.75),
        (7, 1260407.28 + 1289977.00 + 1277462.50 + 1378648.35 + 1249565.34 + 1679334.75 + 1517698.16),
        (8, 1260407.28 + 1289977.00 + 1277462.50 + 1378648.35 + 1249565.34 + 1679334.75 + 1517698.16 + 1957251.97),
        (9, 1260407.28 + 1289977.00 + 1277462.50 + 1378648.35 + 1249565.34 + 1679334.75 + 1517698.16 + 1957251.97 + 1881439.92),
        (10, 1260407.28 + 1289977.00 + 1277462.50 + 1378648.35 + 1249565.34 + 1679334.75 + 1517698.16 + 1957251.97 + 1881439.92 + 1896711.52),
        (11, 1260407.28 + 1289977.00 + 1277462.50 + 1378648.35 + 1249565.34 + 1679334.75 + 1517698.16 + 1957251.97 + 1881439.92 + 1896711.52 + 2070247.93),
        (12, 19497490.26)  # Total anual 2022
    ]
    
    for mes, valor in dados_101_2022:
        status = inserir_ou_atualizar(101, mes, 2022, valor)
        print(f"  ‚úÖ 2022/{mes:02d}: R$ {valor:,.2f} ({status})")
        total_inserido += 1
    
    # 2023 - Acumulado m√™s a m√™s
    dados_101_2023 = [
        (1, 1820196.86),
        (2, 1820196.86 + 1876313.00),
        (3, 1820196.86 + 1876313.00 + 2012322.72),
        (4, 1820196.86 + 1876313.00 + 2012322.72 + 1910801.27),
        (5, 1820196.86 + 1876313.00 + 2012322.72 + 1910801.27 + 2239750.21),
        (6, 1820196.86 + 1876313.00 + 2012322.72 + 1910801.27 + 2239750.21 + 1967979.63),
        (7, 1820196.86 + 1876313.00 + 2012322.72 + 1910801.27 + 2239750.21 + 1967979.63 + 2327903.28),
        (8, 1820196.86 + 1876313.00 + 2012322.72 + 1910801.27 + 2239750.21 + 1967979.63 + 2327903.28 + 2452495.87),
        (9, 1820196.86 + 1876313.00 + 2012322.72 + 1910801.27 + 2239750.21 + 1967979.63 + 2327903.28 + 2452495.87 + 2412553.33),
        (10, 1820196.86 + 1876313.00 + 2012322.72 + 1910801.27 + 2239750.21 + 1967979.63 + 2327903.28 + 2452495.87 + 2412553.33 + 3094133.32),
        (11, 1820196.86 + 1876313.00 + 2012322.72 + 1910801.27 + 2239750.21 + 1967979.63 + 2327903.28 + 2452495.87 + 2412553.33 + 3094133.32 + 3204661.26),
        (12, 27921277.02)  # Total anual 2023
    ]
    
    for mes, valor in dados_101_2023:
        status = inserir_ou_atualizar(101, mes, 2023, valor)
        print(f"  ‚úÖ 2023/{mes:02d}: R$ {valor:,.2f} ({status})")
        total_inserido += 1
    
    # 2024 - Acumulado m√™s a m√™s
    dados_101_2024 = [
        (1, 2578933.66),
        (2, 2578933.66 + 2148673.53),
        (3, 2578933.66 + 2148673.53 + 2084884.15),
        (4, 2578933.66 + 2148673.53 + 2084884.15 + 2457701.28),
        (5, 2578933.66 + 2148673.53 + 2084884.15 + 2457701.28 + 2711292.85),
        (6, 2578933.66 + 2148673.53 + 2084884.15 + 2457701.28 + 2711292.85 + 2700955.18),
        (7, 2578933.66 + 2148673.53 + 2084884.15 + 2457701.28 + 2711292.85 + 2700955.18 + 2679545.50),
        (8, 2578933.66 + 2148673.53 + 2084884.15 + 2457701.28 + 2711292.85 + 2700955.18 + 2679545.50 + 2425979.87),
        (9, 2578933.66 + 2148673.53 + 2084884.15 + 2457701.28 + 2711292.85 + 2700955.18 + 2679545.50 + 2425979.87 + 2574696.56),
        (10, 2578933.66 + 2148673.53 + 2084884.15 + 2457701.28 + 2711292.85 + 2700955.18 + 2679545.50 + 2425979.87 + 2574696.56 + 3173923.50),
        (11, 2578933.66 + 2148673.53 + 2084884.15 + 2457701.28 + 2711292.85 + 2700955.18 + 2679545.50 + 2425979.87 + 2574696.56 + 3173923.50 + 2796051.30),
        (12, 30963568.49)  # Total anual 2024
    ]
    
    for mes, valor in dados_101_2024:
        status = inserir_ou_atualizar(101, mes, 2024, valor)
        print(f"  ‚úÖ 2024/{mes:02d}: R$ {valor:,.2f} ({status})")
        total_inserido += 1
    
    print()
    

    # =========================================================================
    # ID 52 - ATIVO CIRCULANTE (2024)
    # =========================================================================
    print("üìä Inserindo ID 52 - ATIVO CIRCULANTE (2024)...")
    
    dados_52_2024 = [
        (1, 7614164.05), 
        (2, 6689524.73), 
        (3, 6724117.45), 
        (4, 7328238.50),
        (5, 7580302.55), 
        (6, 7655425.85), 
        (7, 7747317.89), 
        (8, 7121054.67),
        (9, 7576952.54), 
        (10, 8836997.34), 
        (11, 7945366.94), 
        (12, 7313531.30)
    ]
    
    for mes, valor in dados_52_2024:
        status = inserir_ou_atualizar(52, mes, 2024, valor)
        print(f"  ‚úÖ 2024/{mes:02d}: R$ {valor:,.2f} ({status})")
        total_inserido += 1
    
    print()
    # COMMIT FINAL
    db.session.commit()
    
    print("=" * 70)
    print(f"‚úÖ CONCLU√çDO! Total de {total_inserido} valores inseridos/atualizados")
    print("=" * 70)
    print()
    print("üîí Estes dados est√£o PROTEGIDOS e n√£o ser√£o recalculados.")
    print("üöÄ A calculadora s√≥ ir√° calcular dados de 2025 em diante.")
    print()

if __name__ == '__main__':
    main()